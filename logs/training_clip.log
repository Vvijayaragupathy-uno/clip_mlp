nohup: ignoring input
================================================================================
OpenAI CLIP + MLP for Ocular Toxoplasmosis Classification
================================================================================
Device: cuda

================================================================================
Loading CLIP Model
================================================================================
✓ Loaded CLIP ViT-B/32

================================================================================
Preparing Data
================================================================================
✓ Training samples: 329
✓ Validation samples: 83

================================================================================
Building Model
================================================================================
CLIP encoder frozen - only training MLP head

✓ Model Configuration:
  - Backbone: CLIP ViT-B/32
  - Backbone frozen: True
  - MLP architecture: 512 -> 512 -> 256 -> 3
  - Dropout: 0.4
  - Classes: ['healthy', 'active', 'inactive']
  - Total parameters: 151,673,604
  - Trainable parameters: 396,291

================================================================================
Starting Training
================================================================================
Epoch [1/100] Step [10/21] Loss: 1.0135
Epoch [1/100] Step [20/21] Loss: 0.8319
Epoch [2/100] Step [10/21] Loss: 0.5715
Epoch [2/100] Step [20/21] Loss: 0.4548
Epoch [3/100] Step [10/21] Loss: 0.6849
Epoch [3/100] Step [20/21] Loss: 0.8053
Epoch [4/100] Step [10/21] Loss: 0.3392
Epoch [4/100] Step [20/21] Loss: 0.8663
Epoch [5/100] Step [10/21] Loss: 0.3792
Epoch [5/100] Step [20/21] Loss: 0.4644

================================================================================
Epoch 5 - Validation Accuracy: 0.7711 (77.11%)
================================================================================

✓ Saved best model with accuracy: 0.7711
Epoch [6/100] Step [10/21] Loss: 0.6254
Epoch [6/100] Step [20/21] Loss: 0.7641
Epoch [7/100] Step [10/21] Loss: 0.2976
Epoch [7/100] Step [20/21] Loss: 0.4979
Epoch [8/100] Step [10/21] Loss: 0.2832
Epoch [8/100] Step [20/21] Loss: 0.3042
Epoch [9/100] Step [10/21] Loss: 0.1986
Epoch [9/100] Step [20/21] Loss: 0.4035
Epoch [10/100] Step [10/21] Loss: 0.8533
Epoch [10/100] Step [20/21] Loss: 0.5013

================================================================================
Epoch 10 - Validation Accuracy: 0.7470 (74.70%)
================================================================================

Epoch [11/100] Step [10/21] Loss: 0.4540
Epoch [11/100] Step [20/21] Loss: 0.8091
Epoch [12/100] Step [10/21] Loss: 0.6359
Epoch [12/100] Step [20/21] Loss: 0.6635
Epoch [13/100] Step [10/21] Loss: 0.2403
Epoch [13/100] Step [20/21] Loss: 0.3865
Epoch [14/100] Step [10/21] Loss: 0.3791
Epoch [14/100] Step [20/21] Loss: 1.0499
Epoch [15/100] Step [10/21] Loss: 0.2276
Epoch [15/100] Step [20/21] Loss: 0.2460

================================================================================
Epoch 15 - Validation Accuracy: 0.7831 (78.31%)
================================================================================

✓ Saved best model with accuracy: 0.7831
Epoch [16/100] Step [10/21] Loss: 0.2269
Epoch [16/100] Step [20/21] Loss: 0.2725
Epoch [17/100] Step [10/21] Loss: 0.6354
Epoch [17/100] Step [20/21] Loss: 0.6635
Epoch [18/100] Step [10/21] Loss: 0.7397
Epoch [18/100] Step [20/21] Loss: 0.4033
Epoch [19/100] Step [10/21] Loss: 0.3738
Epoch [19/100] Step [20/21] Loss: 0.6507
Epoch [20/100] Step [10/21] Loss: 0.2700
Epoch [20/100] Step [20/21] Loss: 0.2474

================================================================================
Epoch 20 - Validation Accuracy: 0.8313 (83.13%)
================================================================================

✓ Saved best model with accuracy: 0.8313
Epoch [21/100] Step [10/21] Loss: 0.6111
Epoch [21/100] Step [20/21] Loss: 0.3076
Epoch [22/100] Step [10/21] Loss: 0.6857
Epoch [22/100] Step [20/21] Loss: 0.4673
Epoch [23/100] Step [10/21] Loss: 0.4974
Epoch [23/100] Step [20/21] Loss: 0.4530
Epoch [24/100] Step [10/21] Loss: 0.5054
Epoch [24/100] Step [20/21] Loss: 0.4678
Epoch [25/100] Step [10/21] Loss: 0.4652
Epoch [25/100] Step [20/21] Loss: 0.2645

================================================================================
Epoch 25 - Validation Accuracy: 0.8072 (80.72%)
================================================================================

Epoch [26/100] Step [10/21] Loss: 0.1518
Epoch [26/100] Step [20/21] Loss: 0.2531
Epoch [27/100] Step [10/21] Loss: 0.4282
Epoch [27/100] Step [20/21] Loss: 0.4525
Epoch [28/100] Step [10/21] Loss: 0.2839
Epoch [28/100] Step [20/21] Loss: 0.5430
Epoch [29/100] Step [10/21] Loss: 0.2837
Epoch [29/100] Step [20/21] Loss: 0.4300
Epoch [30/100] Step [10/21] Loss: 0.4032
Epoch [30/100] Step [20/21] Loss: 0.2296

================================================================================
Epoch 30 - Validation Accuracy: 0.8313 (83.13%)
================================================================================

Epoch [31/100] Step [10/21] Loss: 0.3630
Epoch [31/100] Step [20/21] Loss: 0.4226
Epoch [32/100] Step [10/21] Loss: 0.3417
Epoch [32/100] Step [20/21] Loss: 0.5487
Epoch [33/100] Step [10/21] Loss: 0.2303
Epoch [33/100] Step [20/21] Loss: 0.6126
Epoch [34/100] Step [10/21] Loss: 0.1875
Epoch [34/100] Step [20/21] Loss: 0.1621
Epoch [35/100] Step [10/21] Loss: 0.1986
Epoch [35/100] Step [20/21] Loss: 0.2599

================================================================================
Epoch 35 - Validation Accuracy: 0.8193 (81.93%)
================================================================================

Epoch [36/100] Step [10/21] Loss: 0.3385
Epoch [36/100] Step [20/21] Loss: 0.1281
Epoch [37/100] Step [10/21] Loss: 0.1624
Epoch [37/100] Step [20/21] Loss: 0.2225
Epoch [38/100] Step [10/21] Loss: 0.3606
Epoch [38/100] Step [20/21] Loss: 0.2472
Epoch [39/100] Step [10/21] Loss: 0.5891
Epoch [39/100] Step [20/21] Loss: 0.4930
Epoch [40/100] Step [10/21] Loss: 0.1811
Epoch [40/100] Step [20/21] Loss: 0.2408

================================================================================
Epoch 40 - Validation Accuracy: 0.8313 (83.13%)
================================================================================

Epoch [41/100] Step [10/21] Loss: 0.8408
Epoch [41/100] Step [20/21] Loss: 0.3261
Epoch [42/100] Step [10/21] Loss: 0.3647
Epoch [42/100] Step [20/21] Loss: 0.1095
Epoch [43/100] Step [10/21] Loss: 0.1395
Epoch [43/100] Step [20/21] Loss: 0.1627
Epoch [44/100] Step [10/21] Loss: 0.2933
Epoch [44/100] Step [20/21] Loss: 0.2160
Epoch [45/100] Step [10/21] Loss: 0.7181
Epoch [45/100] Step [20/21] Loss: 0.2308

================================================================================
Epoch 45 - Validation Accuracy: 0.8554 (85.54%)
================================================================================

✓ Saved best model with accuracy: 0.8554
Epoch [46/100] Step [10/21] Loss: 0.0951
Epoch [46/100] Step [20/21] Loss: 0.4489
Epoch [47/100] Step [10/21] Loss: 0.4622
Epoch [47/100] Step [20/21] Loss: 1.3760
Epoch [48/100] Step [10/21] Loss: 0.4949
Epoch [48/100] Step [20/21] Loss: 0.1661
Epoch [49/100] Step [10/21] Loss: 0.2000
Epoch [49/100] Step [20/21] Loss: 0.5739
Epoch [50/100] Step [10/21] Loss: 0.2005
Epoch [50/100] Step [20/21] Loss: 0.5466

================================================================================
Epoch 50 - Validation Accuracy: 0.8313 (83.13%)
================================================================================

Epoch [51/100] Step [10/21] Loss: 0.1545
Epoch [51/100] Step [20/21] Loss: 0.2466
Epoch [52/100] Step [10/21] Loss: 0.4271
Epoch [52/100] Step [20/21] Loss: 0.2623
Epoch [53/100] Step [10/21] Loss: 0.9527
Epoch [53/100] Step [20/21] Loss: 0.2100
Epoch [54/100] Step [10/21] Loss: 0.2528
Epoch [54/100] Step [20/21] Loss: 0.2029
Epoch [55/100] Step [10/21] Loss: 0.2181
Epoch [55/100] Step [20/21] Loss: 0.2973

================================================================================
Epoch 55 - Validation Accuracy: 0.8554 (85.54%)
================================================================================

Epoch [56/100] Step [10/21] Loss: 0.2618
Epoch [56/100] Step [20/21] Loss: 0.0933
Epoch [57/100] Step [10/21] Loss: 0.0869
Epoch [57/100] Step [20/21] Loss: 0.1745
Epoch [58/100] Step [10/21] Loss: 0.3524
Epoch [58/100] Step [20/21] Loss: 0.2128
Epoch [59/100] Step [10/21] Loss: 0.3485
Epoch [59/100] Step [20/21] Loss: 0.6556
Epoch [60/100] Step [10/21] Loss: 0.0831
Epoch [60/100] Step [20/21] Loss: 0.2172

================================================================================
Epoch 60 - Validation Accuracy: 0.8313 (83.13%)
================================================================================

Epoch [61/100] Step [10/21] Loss: 0.2788
Epoch [61/100] Step [20/21] Loss: 0.1588
Epoch [62/100] Step [10/21] Loss: 0.2340
Epoch [62/100] Step [20/21] Loss: 0.5274
Epoch [63/100] Step [10/21] Loss: 0.1929
Epoch [63/100] Step [20/21] Loss: 0.2555
Epoch [64/100] Step [10/21] Loss: 0.8046
Epoch [64/100] Step [20/21] Loss: 0.4613
Epoch [65/100] Step [10/21] Loss: 0.2748
Epoch [65/100] Step [20/21] Loss: 0.1361

================================================================================
Epoch 65 - Validation Accuracy: 0.8313 (83.13%)
================================================================================

Epoch [66/100] Step [10/21] Loss: 0.2104
Epoch [66/100] Step [20/21] Loss: 0.1614
Epoch [67/100] Step [10/21] Loss: 0.3505
Epoch [67/100] Step [20/21] Loss: 0.3153
Epoch [68/100] Step [10/21] Loss: 0.1034
Epoch [68/100] Step [20/21] Loss: 0.2114
Epoch [69/100] Step [10/21] Loss: 0.1866
Epoch [69/100] Step [20/21] Loss: 0.3492
Epoch [70/100] Step [10/21] Loss: 0.1235
Epoch [70/100] Step [20/21] Loss: 0.5300

================================================================================
Epoch 70 - Validation Accuracy: 0.8193 (81.93%)
================================================================================

Epoch [71/100] Step [10/21] Loss: 0.1947
Epoch [71/100] Step [20/21] Loss: 0.3847
Epoch [72/100] Step [10/21] Loss: 0.0586
Epoch [72/100] Step [20/21] Loss: 0.3902
Epoch [73/100] Step [10/21] Loss: 0.2221
Epoch [73/100] Step [20/21] Loss: 0.1465
Epoch [74/100] Step [10/21] Loss: 0.1835
Epoch [74/100] Step [20/21] Loss: 0.3110
Epoch [75/100] Step [10/21] Loss: 0.0377
Epoch [75/100] Step [20/21] Loss: 0.0821

================================================================================
Epoch 75 - Validation Accuracy: 0.8434 (84.34%)
================================================================================

Epoch [76/100] Step [10/21] Loss: 0.3397
Epoch [76/100] Step [20/21] Loss: 0.7320
Epoch [77/100] Step [10/21] Loss: 0.3560
Epoch [77/100] Step [20/21] Loss: 0.2905
Epoch [78/100] Step [10/21] Loss: 0.3302
Epoch [78/100] Step [20/21] Loss: 0.4077
Epoch [79/100] Step [10/21] Loss: 0.1495
Epoch [79/100] Step [20/21] Loss: 0.1084
Epoch [80/100] Step [10/21] Loss: 0.3778
Epoch [80/100] Step [20/21] Loss: 0.1124

================================================================================
Epoch 80 - Validation Accuracy: 0.8434 (84.34%)
================================================================================

Epoch [81/100] Step [10/21] Loss: 0.1401
Epoch [81/100] Step [20/21] Loss: 0.1263
Epoch [82/100] Step [10/21] Loss: 0.3494
Epoch [82/100] Step [20/21] Loss: 0.4074
Epoch [83/100] Step [10/21] Loss: 0.1868
Epoch [83/100] Step [20/21] Loss: 0.1447
Epoch [84/100] Step [10/21] Loss: 0.1434
Epoch [84/100] Step [20/21] Loss: 0.2099
Epoch [85/100] Step [10/21] Loss: 0.1932
Epoch [85/100] Step [20/21] Loss: 0.4722

================================================================================
Epoch 85 - Validation Accuracy: 0.8434 (84.34%)
================================================================================

Epoch [86/100] Step [10/21] Loss: 0.1639
Epoch [86/100] Step [20/21] Loss: 0.6154
Epoch [87/100] Step [10/21] Loss: 0.3794
Epoch [87/100] Step [20/21] Loss: 0.1637
Epoch [88/100] Step [10/21] Loss: 0.1425
Epoch [88/100] Step [20/21] Loss: 0.1379
Epoch [89/100] Step [10/21] Loss: 1.0638
Epoch [89/100] Step [20/21] Loss: 0.0539
Epoch [90/100] Step [10/21] Loss: 0.7169
Epoch [90/100] Step [20/21] Loss: 0.1323

================================================================================
Epoch 90 - Validation Accuracy: 0.8193 (81.93%)
================================================================================

Epoch [91/100] Step [10/21] Loss: 0.0520
Epoch [91/100] Step [20/21] Loss: 0.1776
Epoch [92/100] Step [10/21] Loss: 0.0623
Epoch [92/100] Step [20/21] Loss: 0.1337
Epoch [93/100] Step [10/21] Loss: 0.1176
Epoch [93/100] Step [20/21] Loss: 0.4381
Epoch [94/100] Step [10/21] Loss: 0.2233
Epoch [94/100] Step [20/21] Loss: 0.3510
Epoch [95/100] Step [10/21] Loss: 0.2714
Epoch [95/100] Step [20/21] Loss: 0.0969

================================================================================
Epoch 95 - Validation Accuracy: 0.8434 (84.34%)
================================================================================

Epoch [96/100] Step [10/21] Loss: 0.4209
Epoch [96/100] Step [20/21] Loss: 0.2117
Epoch [97/100] Step [10/21] Loss: 0.1434
Epoch [97/100] Step [20/21] Loss: 0.8856
Epoch [98/100] Step [10/21] Loss: 0.1926
Epoch [98/100] Step [20/21] Loss: 0.5432
Epoch [99/100] Step [10/21] Loss: 0.1354
Epoch [99/100] Step [20/21] Loss: 0.1990
Epoch [100/100] Step [10/21] Loss: 0.0862
Epoch [100/100] Step [20/21] Loss: 0.3927

================================================================================
Epoch 100 - Validation Accuracy: 0.8434 (84.34%)
================================================================================


================================================================================
Training Complete!
Best Validation Accuracy: 0.8554 (85.54%)
================================================================================

================================================================================
Final Evaluation on Validation Set
================================================================================

Classification Report:
              precision    recall  f1-score   support

     healthy     0.8966    0.9630    0.9286        27
      active     0.8462    0.6111    0.7097        18
    inactive     0.8293    0.8947    0.8608        38

    accuracy                         0.8554        83
   macro avg     0.8573    0.8229    0.8330        83
weighted avg     0.8548    0.8554    0.8501        83


Confusion Matrix:
[[26  0  1]
 [ 1 11  6]
 [ 2  2 34]]

Class order: ['healthy', 'active', 'inactive']

✓ Overall Accuracy: 0.8554 (85.54%)

================================================================================
✓ All Done!
✓ Best model saved to: ./checkpoints/toxoplasmosis_clip_mlp/best_model.pth
================================================================================
